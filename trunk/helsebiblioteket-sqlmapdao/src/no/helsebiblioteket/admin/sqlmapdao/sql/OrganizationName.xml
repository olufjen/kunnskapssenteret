<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="OrganizationName">
	<typeAlias alias="organizationName" type="no.helsebiblioteket.admin.domain.OrganizationName"/>
	<resultMap id="getOrganizationNameResultMap" class="organizationName">
		<result property="id" column="org_unit_name_id" />
		<result property="languageCode" column="language_code" />
		<result property="name" column="name" />
		<result property="organizationId" column="org_unit_id" />
		<result property="category" column="category" />
		<result property="lastChanged" column="last_changed" />
	</resultMap>
	<select id="getOrganizationNameById" resultMap="getOrganizationNameResultMap" parameterClass="integer">
		select org_unit_name_id, language_code, name, org_unit_id, category, last_changed
		from tbl_org_unit_name
		where org_unit_name_id = #organizationNameId#;
	</select>
	<select id="getOrganizationNameList" resultMap="getOrganizationNameResultMap">
		select org_unit_name_id, language_code, name, org_unit_id, category, last_changed
		from tbl_org_unit_name
	</select>
	<select id="getOrganizationNameListByOrganizationId" resultMap="getOrganizationNameResultMap">
		select org_unit_name_id, language_code, name, org_unit_id, category, last_changed
		from tbl_org_unit_name
		where org_unit_id = #organizationId#
	</select>
	<insert id="insertOrganizationName" parameterClass="organizationName">
		<selectKey resultClass="int" keyProperty="id">
			SELECT nextval('tbl_org_unit_name_org_unit_name_id_seq') as id;
		</selectKey>
		insert into tbl_org_unit_name (org_unit_name_id, language_code, name, category, org_unit_id, last_changed)
		values (#id#, #languageCode#, #name#, #category#, #organizationId#, now());
	</insert>
	<update id="updateOrganizationName" parameterClass="organizationName">
		update tbl_org_unit_name set
		language_code = #languageCode#,
		name = #name#,
		org_unit_id = #organizationId#,
		category = #category#,
      	last_changed = now()
    	where org_unit_name_id = #id# and
    	last_changed = #lastChanged#;
  </update>
  <delete id="deleteOrganizationName" parameterClass="organizationName">
  		delete from tbl_org_unit_name
  		where
  		org_unit_name_id = #id#;
  </delete>
</sqlMap>
