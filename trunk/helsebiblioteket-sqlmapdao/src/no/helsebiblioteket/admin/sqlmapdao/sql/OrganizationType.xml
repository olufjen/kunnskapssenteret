<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="OrganizationType">
	<typeAlias alias="OrganizationType" type="no.helsebiblioteket.admin.domain.OrganizationType"/>
	<cacheModel id="OrganizationTypeCache" type="LRU" readOnly="false" serialize="true">
		<flushInterval hours="24"/>
		<flushOnExecute statement="insertOrganizationType"/>
		<property name="size" value="1000" />
	</cacheModel>
	<resultMap id="OrganizationTypeResultMap" class="OrganizationType">
		<result property="orgTypeId" column="org_type_id" />
		<result property="description" column="descr" />
		<result property="name" column="name" />
		<result property="key.value" column="key" />
	</resultMap>

	<insert id="insertOrganizationType" parameterClass="OrganizationType">
		<selectKey resultClass="int" keyProperty="access_id">
			SELECT nextval('tbl_org_type_reg_org_type_id_seq') as orgTypeId;
		</selectKey>
		insert into tbl_org_type_reg (
			org_type_id, 
			descr, 
			name, 
			key
		) values (
			#orgTypeId#, #description#, #name#, #key#
		);
	</insert>
	<select id="getOrganizationTypeByKey" cacheModel="organizationTypeCache" resultMap="OrganizationTypeResultMap" parameterClass="string">
		select org_type_id, descr, name, key
		from tbl_org_type_reg
		where key = #organizationTypeKey#;
	</select>
	<select id="getOrganizationTypeListAll" cacheModel="organizationTypeCache" resultMap="OrganizationTypeResultMap">
		select org_type_id, descr, name, key
		from tbl_org_type_reg
	</select>
	<select id="getOrganizationTypeById" cacheModel="organizationTypeCache" resultMap="OrganizationTypeResultMap" parameterClass="integer">
		select org_type_id, descr, name, key
		from tbl_org_type_reg
		where org_type_id = #id#;
	</select>
</sqlMap>
