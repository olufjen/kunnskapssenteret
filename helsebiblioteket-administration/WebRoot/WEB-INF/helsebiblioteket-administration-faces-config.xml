<?xml version="1.0"?>

<!DOCTYPE faces-config PUBLIC
  "-//Sun Microsystems, Inc.//DTD JavaServer Faces Config 1.0//EN"
  "http://java.sun.com/dtd/web-facesconfig_1_0.dtd" [
]>

<faces-config>
  	
  	<application>
  		<!--<variable-resolver>org.springframework.web.jsf.SpringBeanVariableResolver</variable-resolver>-->
  		<variable-resolver>org.springframework.web.jsf.DelegatingVariableResolver</variable-resolver>
		<locale-config>
	      		<default-locale>en</default-locale>
	      		<supported-locale>en</supported-locale>
	      		<supported-locale>no</supported-locale>
    	</locale-config>
    	<message-bundle>
			no.helsebiblioteket.admin.web.jsf.messageresources.errors
		</message-bundle>
    	<!--<variable-resolver>org.springframework.web.jsf.SpringBeanVariableResolver</variable-resolver>-->
    	<!--<el-resolver>org.springframework.web.jsf.el.SpringBeanFacesELResolver</el-resolver>-->
    	<view-handler>org.apache.myfaces.tomahawk.application.jsp.JspTilesViewHandlerImpl</view-handler>
	</application>
	<navigation-rule>
		<navigation-case>
			<from-action>#{userBean.getUser}</from-action>
			<to-view-id>/user.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
 	
	<navigation-rule>
		<from-view-id>/login.jsp</from-view-id>
		<navigation-case>
			<from-outcome>login</from-outcome>
			<to-view-id>/j_spring_security_check</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
        <from-view-id>*</from-view-id>
        <navigation-case>
                <from-outcome>logout</from-outcome>
                <to-view-id>/j_spring_security_logout</to-view-id>
        </navigation-case>
	</navigation-rule>
	
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>login</from-outcome>
			<to-view-id>/login.faces</to-view-id> 
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>login_success</from-outcome>
			<to-view-id>/welcome.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>welcome</from-outcome>
			<to-view-id>/welcome.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>create_change_supplier_organization</from-outcome>
			<to-view-id>/create-change-supplierorganization.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>create_change_member_organization</from-outcome>
			<to-view-id>/create-change-memberorganization.faces</to-view-id>
		</navigation-case>
	</navigation-rule>

	<navigation-rule>
		<navigation-case>
			<from-outcome>edit_organization_type</from-outcome>
			<to-view-id>/organization-type-edit.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>organization_types_overview</from-outcome>
			<to-view-id>/organization-types-overview.faces</to-view-id>
		</navigation-case>
	</navigation-rule>

	<navigation-rule>
		<!-- TODO: Use this? <from-view-id>/organizations-overview.tiles</from-view-id>-->
		<navigation-case>
			<from-outcome>organizations_overview</from-outcome>
			<to-view-id>/organizations-overview.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>organization_details</from-outcome>
			<to-view-id>/organization-details.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>organization_edit</from-outcome>
			<to-view-id>/organization-edit.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>ip_change_emails</from-outcome>
			<to-view-id>/ip-change-emails.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
			
	<navigation-rule>
		<!-- TODO: Use this? <from-view-id>/user-new.tiles</from-view-id>-->
		<navigation-case>
			<from-outcome>create-enduser</from-outcome>
			<to-view-id>/new-enduser.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>create-administrator</from-outcome>
			<to-view-id>/new-administrator.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>users_overview</from-outcome>
			<to-view-id>/users-overview.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>user_details</from-outcome>
			<to-view-id>/user-details.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>user_edit</from-outcome>
			<to-view-id>/user-edit.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>edit_role</from-outcome>
			<to-view-id>/role-edit.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>roles_overview</from-outcome>
			<to-view-id>/roles-overview.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>cancel_national_access</from-outcome>
			<to-view-id>/welcome.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>save_national_access</from-outcome>
			<to-view-id>/welcome.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
	    	<from-action>#{exportBean.actionExportUserList}</from-action>
		    <to-view-id>/export.faces</to-view-id>
		</navigation-case>
	</navigation-rule>

	<navigation-rule>
		<navigation-case>
			<from-outcome>export_proxy_return</from-outcome>
		    <to-view-id>/export-proxy.faces</to-view-id>
		</navigation-case>
	</navigation-rule>

	<navigation-rule>
		<navigation-case>
			<from-outcome>export_proxy_result</from-outcome>
		    <to-view-id>/export-proxy-result.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<!-- TODO: Use from view?  -->
		<!-- <from-view-id>/forgotten-password.tiles</from-view-id> -->
		<navigation-case>
			<from-outcome>send_email_success</from-outcome>
			<to-view-id>/forgotten-password-sent.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>goto_forgotten</from-outcome>
			<to-view-id>/forgotten-password.faces</to-view-id>
		</navigation-case>
	</navigation-rule>

	<navigation-rule>
		<!-- TODO: Use from view?  -->
		<!-- <from-view-id>forgotten-password-sent.tiles</from-view-id>  -->
		<navigation-case>
			<!-- TODO: Use action?  -->
	    	<from-action>#{loginBean.actionBackToLogin}</from-action>
		    <from-outcome>back_to_login</from-outcome>
		    <to-view-id>/login.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<navigation-rule>
		<navigation-case>
			<from-outcome>edit_member_organization</from-outcome>
			<to-view-id>/member-organization-edit.faces</to-view-id>
		</navigation-case>
		<navigation-case>
			<from-outcome>member_organization</from-outcome>
			<to-view-id>/member-organization-details.faces</to-view-id>
		</navigation-case>
	</navigation-rule>
	
	<managed-bean>
    	<description>Organization domain object</description>
        <display-name>Orgnization domain object</display-name>
        <managed-bean-name>organization</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.domain.Organization</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
	</managed-bean>
	
	<managed-bean>
    	<description>Backingbean the welcome page</description>
        <display-name>welcome</display-name>
        <managed-bean-name>welcomeBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.WelcomeBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
	</managed-bean>	
	 
    <managed-bean>
    	<description>Backingbean related to "user"</description>
        <display-name>user</display-name>
        <managed-bean-name>userBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.UserBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    	<managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
		<managed-property>
            <property-name>organizationService</property-name>
            <value>#{organizationService}</value>
        </managed-property>
	</managed-bean> 
	
	<managed-bean>
    	<description>Backingbean related to exporting data</description>
        <display-name>export</display-name>
        <managed-bean-name>exportBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.ExportBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    	<managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
	</managed-bean> 

	<managed-bean>
    	<description>Backingbean related to exporting proxy data</description>
        <display-name>proxy export</display-name>
        <managed-bean-name>exportProxyBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.ExportProxyBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    	<managed-property>
    		<property-name>organizationService</property-name>
        	<value>#{organizationService}</value>
		</managed-property>
    	<managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
    	<managed-property>
    		<property-name>imageRenderer</property-name>
        	<value>no.helsebiblioteket.admin.web.jsf.JPEGImageRenderer</value>
		</managed-property>
	</managed-bean> 
	
	<managed-bean>
    	<description>Backingbean related to the user language</description>
        <display-name>header</display-name>
        <managed-bean-name>headerBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.HeaderBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
	</managed-bean>

	<managed-bean>
    	<description>Backingbean related to login</description>
        <display-name>Login</display-name>
        <managed-bean-name>loginBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.LoginBean</managed-bean-class>
        <managed-bean-scope>request</managed-bean-scope>
		<managed-property>
    		<property-name>loginService</property-name>
        	<value>#{loginService}</value>
		</managed-property>
		<managed-property>
    		<property-name>emailLostPasswordAdminTemplate</property-name>
        	<value>#{emailLostPasswordAdminTemplate}</value>
		</managed-property>
	</managed-bean>

	<managed-bean>
    	<description>Backingbean related to Adding a user</description>
        <display-name>New User</display-name>
        <managed-bean-name>newUserBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.NewUserBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
        <managed-property>
    		<property-name>userBean</property-name>
        	<value>#{userBean}</value>
		</managed-property>
	</managed-bean>

	<managed-bean>
    	<description>Backingbean related to Adding an end user</description>
        <display-name>New End User Bean</display-name>
        <managed-bean-name>newEndUserBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.NewEndUserBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
        <managed-property>
    		<property-name>userBean</property-name>
        	<value>#{userBean}</value>
		</managed-property>
    	<managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
		<managed-property>
            <property-name>organizationService</property-name>
            <value>#{organizationService}</value>
        </managed-property>
	</managed-bean>

	<managed-bean>
    	<description>Backingbean related to Adding an administrator</description>
        <display-name>New Administrator Bean</display-name>
        <managed-bean-name>newAdministratorBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.NewAdministratorBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
        <managed-property>
    		<property-name>userBean</property-name>
        	<value>#{userBean}</value>
		</managed-property>
        <managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
		<managed-property>
            <property-name>organizationService</property-name>
            <value>#{organizationService}</value>
        </managed-property>
	</managed-bean>
	
	<managed-bean>
    	<description>Backingbean related to creating a new member organization</description>
        <display-name>New member organization Bean</display-name>
        <managed-bean-name>createAndChangeMemberOrganizationBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.CreateAndChangeMemberOrganizationBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
        <managed-property>
    		<property-name>organizationService</property-name>
        	<value>#{organizationService}</value>
		</managed-property>
        <managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
		<managed-property>
    		<property-name>organizationBean</property-name>
        	<value>#{organizationBean}</value>
		</managed-property>
	</managed-bean>
	
	<managed-bean>
    	<description>Backingbean related to creating a new supplier organization</description>
        <display-name>New supplier Bean</display-name>
        <managed-bean-name>createAndChangeSupplierOrganizationBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.CreateAndChangeSupplierOrganizationBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
        <managed-property>
    		<property-name>organizationService</property-name>
        	<value>#{organizationService}</value>
		</managed-property>
    	<managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
		<managed-property>
    		<property-name>organizationBean</property-name>
        	<value>#{organizationBean}</value>
		</managed-property>
	</managed-bean> 
	 
	<managed-bean>
    	<description>Backingbean related to common lookup operations (types of entities for dropdown lists etc)</description>
        <display-name>adminBean</display-name>
        <managed-bean-name>adminBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.AdminBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    	<managed-property>
    		<property-name>organizationService</property-name>
        	<value>#{organizationService}</value>
		</managed-property>
		<managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
	</managed-bean>

	<managed-bean>
    	<description>Backingbean related to organizations</description>
        <display-name>organizationBean</display-name>
        <managed-bean-name>organizationBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.OrganizationBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
        <managed-property>
    		<property-name>organizationService</property-name>
        	<value>#{organizationService}</value>
		</managed-property>
        <managed-property>
    		<property-name>accessService</property-name>
        	<value>#{accessService}</value>
		</managed-property>
		<managed-property>
    		<property-name>organization</property-name>
        	<value>#{organization}</value>
		</managed-property>
	</managed-bean>
	
	<managed-bean>
    	<description>Backingbean related to organization types</description>
        <display-name>organizationTypeBean</display-name>
        <managed-bean-name>organizationTypeBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.OrganizationTypeBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
		<managed-property>
            <property-name>organizationService</property-name>
            <value>#{organizationService}</value>
        </managed-property>
        <managed-property>
    		<property-name>accessService</property-name>
        	<value>#{accessService}</value>
		</managed-property>
	</managed-bean>

	<managed-bean>
    	<description>Backingbean related to roles</description>
        <display-name>roleBean</display-name>
        <managed-bean-name>roleBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.RoleBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
		<managed-property>
            <property-name>userService</property-name>
            <value>#{userService}</value>
        </managed-property>
        <managed-property>
    		<property-name>accessService</property-name>
        	<value>#{accessService}</value>
		</managed-property>
		<managed-property>
            <property-name>organizationService</property-name>
            <value>#{organizationService}</value>
        </managed-property>
	</managed-bean>

	<managed-bean>
    	<description>Backingbean related to national access</description>
        <display-name>nationalAccessBean</display-name>
        <managed-bean-name>nationalAccessBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.NationalAccessBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
		<managed-property>
            <property-name>userService</property-name>
            <value>#{userService}</value>
        </managed-property>
        <managed-property>
    		<property-name>accessService</property-name>
        	<value>#{accessService}</value>
		</managed-property>
		<managed-property>
            <property-name>organizationService</property-name>
            <value>#{organizationService}</value>
        </managed-property>
	</managed-bean>
	
	<managed-bean>
    	<description>Backingbean related to "member organizations"</description>
        <display-name>member organization</display-name>
        <managed-bean-name>memberOrganizationBean</managed-bean-name>
        <managed-bean-class>no.helsebiblioteket.admin.bean.MemberOrganizationBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    	<managed-property>
    		<property-name>userService</property-name>
        	<value>#{userService}</value>
		</managed-property>
		<managed-property>
            <property-name>organizationService</property-name>
            <value>#{organizationService}</value>
        </managed-property>
	</managed-bean>

	<validator>
		<validator-id>IntegerOrNullValidator</validator-id>	
		<validator-class>no.helsebiblioteket.jsf.validators.IntegerOrNullValidatorJSF</validator-class>
	</validator>
	
	<validator>
		<validator-id>ImageLogoValidator</validator-id>	
		<validator-class>no.helsebiblioteket.jsf.validators.ImageLogoValidatorJSF</validator-class>
	</validator>

</faces-config>
